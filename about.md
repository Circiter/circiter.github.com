---
layout: page
title: Справка
---

Небольшой персональный <<блог>> (публичный сетевой дневник). Тематика записей
по плану включает в себя изложение обрывочных мыслей и идей
по программированию, радиолюбительской практике, простой электронике,
и вообще занимательной науке.

Материалы оформлены с применением языка разметки [Markdown][md] (а точнее говоря, его варианта ---
kramdown+GFM) и размещены на <s>халяву</s> небезызвестном ресурсе GitHub с использованием статического
генератора [Jekyll][jekyll] в связке с функциональностью непрерывной интеграции, предоставляемой
[относительно новым] механизмом GitHub [Actions][gh-actions] (для поддержки произвольных модулей расширения ---
плагинов --- Jekyll, в частности, плагинов поддержки $\mbox{\LaTeX}$-формул, по невнятным причинам
отключенных во встроенном в GitHub Pages и работающем в безопасном режиме Jekyll-генераторе).

До этого я пытался использовать сторонние сервисы непрерывной интеграции
(CI/CD) вроде Travis CI, Circle CI и некоторые другие, но для верстки статичного блога
это кажется перебором (к тому же, web-интерфейсы Circle CI, и в особенности Travis CI,
немного не дружат с используемыми мною web-обозревателями; с API для некоторых задач, типа
создания новых проектов и привязки их к GitHub-репозиториям, пока
не разобрался).

Впрочем, настроить GitHub Actions оказалось тоже не так просто (кажется, что скудная
документация и нестабильное контр-интуитивное поведение суть не случайности, но меры
--- своеобразный фильтр --- против наплыва пользователей при ограниченных ресурсах
самого GitHub'а :) ). Вначале я пробовал размещать исходные данные (т.е., в основном,
`*.md`-файлы) в единственной на тот момент ветви `master`, в которую же и помещались
сгенерированные файлы. Это решение выглядело неплохим, но на деле выяснилось, что
даже после успешной сборки блога, сервер срабатывает неадекватно и при посещении
ассоциированных web-адресов (в данном случае, <http://circiter.github.io>
и <http://circiter.tk>) выдаётся http-ошибка 404, причем поведение сервера
при указании тех или иных конкретных страниц менялось от опыта к опыту неким
несистематичным непредсказуемым образом. Временно помогал трюк с клонированием
репозитория и отправкой пустого набора изменений (комманда `git commit` с ключем
`--allow-empty`), но и это работало лишь изредка.

Положительные изменения произошли лишь после реорганизации хранилища путем перенесения
исходных данных в новую ветвь `source`. Размещенные вне ветви `master` конфигурационные файлы
(<<workflows>>) механизма GitHub Actions оказались вполне работоспособными, заодно избавив от
необходимости применения дополнительных ухищрений, вроде удаления директории `.github` перед
инициированной конфигурационным файлом GitHub Actions отправкой сгенерированных файлов в
ветвь `master` (данный трюк был использован, --- как позже выяснилось, зря, --- во-избежание
возможных проблем с рекурсивным выполнением назначенных автоматических действий).

Но даже после этого, оставалась одна проблема с серверным хранением
актуальных версий отдаваемых пользователям-посетителям сайта/блога данных. Предположительно, серверное
кэширование приводило к невозможности некоторое время увидеть изменения в публикуемых
страницах даже после их успешной сборки. [Надёжный] способ обхода мне не известен, а может быть
пока и не существует (кроме вышеупомянутого хака с `clone`/`commit`/`push`, --- именно его-то я и
попытался применить на этом блоге, впрочем, безуспешно --- автоматизировать выполнение этой
странной операции с помощью сценария оболочки, выполняющегося при сборке всего проекта
после операции `git push origin source` мне не удалось, не исключено, что именно из-за
существования защиты от рекурсии в GitHub Actions). Впрочем, в какой-то момент, эта проблема исчезла
сама собой, без заметных причин...

Также, к репозиторию, хранящему данный блог, было подключено GitHub-приложение [TeXify][texify] (но <i>de-facto</i>
не было задействовано, в том числе по причине наличия на данный момент некоторых
проблем в генерируемых данным приложением SVG-файлах) для поддержки формул в Markdown-файлах,
просматриваемых в web-интерфейсе GitHub.

В качестве темы оформления сначала была выбрана тема [Hacker][hacker-theme], в некоторой степени из-за лицензии, но в основном
просто из-за внешнего вида). Потом я применил в качестве шаблона другую готовую Jekyll-тему [Hyde][hyde-theme],
так как Hacker с темным фоном мало совместима с печатью страниц на бумаге, в частности и в особенности
при наличии на страницах формул (иначе бы их пришлось визуализировать дважды -- с черным и с белым текстом) и
тем-более диаграмм с цветными элементами на прозрачном фоне. Для интересующихся темой оформления Hacker,
до-кучи приведу ссылку на производную тему [hacker-blog][hacker-blog-theme].

Для поддержки формул пришлось написать отдельный простой плагин (`simplemath.rb`), производящий
верстку исходного кода формул с помощью полноценного $\mbox{\LaTeX}$-движка (из TeXLive) с
последующей конвертацией `*.dvi`-файлов сначала (с помощью dvips) в [encapsulated] PostScript,
потом (с помощью ImageMagick) в PNG. Трудно не согласиться, что такой конвейер выглядит избыточным,
но более простые решения вроде mimetex оказались слишком ограниченными. Впрочем, можно ещё попробовать
встроенный в GitHub API-механизм (`http://render.githubusercontent.com/render/math?math=<url_encoded_formula>`)
рендеринга формул. Странно, что эта возможность за все время своего существования не стала
стандартным способом отображения формул...

И хотя опытный драматург уже смог бы на основе только лишь последнего абзаца написать сценарий к
фильму ужасов, тем не менее это не конец истории. Ведь описанный конвейер работает в
Docker-контейнере! Предполагаемые процессорные и сетевые затраты выглядят несоразмерными с
решаемой задачей, но ведь многие интернет-ресурсы, включая некоторые крупные форумы, давно используют
верстаемые на стороне сервера формулы, и не исключено, что с меньшими накладными расходами;
эта возможность должна стать практически общепринятой. (К сожалению, по-факту, очень часто, слишком
часто приходится сталкиваться с клиентским рендерингом на основе какого-нибудь MathJax'а.)

С целью предъявления читателю относительно счастливой концовки, спешу упомянуть, что блог всё-таки
заработал, с примерно сотого <<commit>>'а...

[![http://jekyllrb.com](/public/images/jekyll-logo.png)][jekyll]

Ссылки:
- [GitHub Pages](https://pages.github.com)
- [Markdown][md]
- [Jekyll][jekyll]
- [Jekyll @ GitHub](https://github.com/jekyll/jekyll)
- [Hyde][hyde-theme]
- [Hyde @ GitHub](https://github.com/poole/hyde)
- [Hacker @ GitHub][hacker-theme]
- [hacker-blog @ GitHub][hacker-blog-theme]
- [GitHub Actions][gh-actions]
- [TeXify][texify]

[md]: http://daringfireball.net/projects/markdown
[jekyll]: http://jekyllrb.com
[hyde-theme]: http://hyde.getpoole.com
[hacker-theme]: https://github.com/pages-themes/hacker
[hacker-blog-theme]: https://github.com/ashishchaudhary/hacker-blog
[gh-actions]: https://github.com/features/actions
[texify]: https://github.com/apps/texify
